
# Python3 Essentials for Pentesters

> **Focus:** using Python 3 to build quick scripts for scanning, banner grabbing, DNS lookups, and web checks during penetration tests.
> **Note:** This updates previous examples from Python 2 to Python 3.

---

## Key differences from Python2
- `print` is now a function: `print("Hello")`
- `raw_input` was replaced by `input`
- `input` always returns a string, need to cast to `int` if needed
- `socket.recv()` returns bytes, so use `.decode()`
- `urllib2` was replaced by `urllib.request`
- Division `/` is always float, use `//` for integer division

---

## Table of Contents
1. [Your First Python3 Script](#1-your-first-python3-script)
2. [Working with Arguments](#2-working-with-arguments)
3. [Conditions and Loops](#3-conditions-and-loops)
4. [Working with Sockets](#4-working-with-sockets)
5. [Building a Port Scanner](#5-building-a-port-scanner)
6. [Banner Grabbing](#6-banner-grabbing)
7. [Interacting with Services](#7-interacting-with-services)
8. [Simple DNS Resolver](#8-simple-dns-resolver)
9. [Basic Web Requests](#9-basic-web-requests)

---

## 1 – Your First Python3 Script
```python
#!/usr/bin/python3
# My first script
print("Desec Security")
ip = input("Enter IP: ")
port = int(input("Enter Port: "))
ver = 1.1

print("Scan version:", ver)
print("Scanning host:", ip, "on port", port)

print("IP - ", type(ip))
print("Port - ", type(port))
print("Ver - ", type(ver))

print("Scanning host: %s on port: %d" % (ip, port))
```

---

## 2 – Working with Arguments
```python
#!/usr/bin/python3
import sys
import os

print("Scanning host:", sys.argv[1], "on port", sys.argv[2])
os.system("netstat -nlpt")
```

---

## 3 – Conditions and Loops
```python
#!/usr/bin/python3
import sys

if len(sys.argv) <= 2:
    print("Usage: script.py <ip> <port>")
else:
    print("Scanning host:", sys.argv[1], "on port", sys.argv[2])

for ip in range(1, 10):
    print(sys.argv[1], ip)
```

---

## 4 – Working with Sockets
```python
#!/usr/bin/python3
import socket
import sys

ip = sys.argv[1]
port = int(sys.argv[2])

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
res = sock.connect_ex((ip, port))

if res == 0:
    print("Port OPEN")
else:
    print("Port CLOSED")
```

---

## 5 – Building a Port Scanner
```python
#!/usr/bin/python3
import socket
import sys

for port in range(1, 65535):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    if sock.connect_ex((sys.argv[1], port)) == 0:
        print("Port", port, "[OPEN]")
    sock.close()
```

---

## 6 – Banner Grabbing
```python
#!/usr/bin/python3
import socket

ip = input("Enter IP: ")
port = int(input("Enter Port: "))

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((ip, port))
banner = sock.recv(1024).decode()
print(banner)
```

---

## 7 – Interacting with Services (FTP Example)
```python
#!/usr/bin/python3
import socket

print("Interacting with FTP Server")
ip = input("Enter IP: ")
port = int(input("Enter Port: "))

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((ip, port))
banner = sock.recv(1024).decode()
print(banner)

print("Sending user")
sock.send(b"USER ricardo
")
print(sock.recv(1024).decode())

print("Sending password")
sock.send(b"PASS ricardo
")
print(sock.recv(1024).decode())
```

---

## 8 – Simple DNS Resolver
```python
#!/usr/bin/python3
import socket
import sys

host = sys.argv[1]
print(host, "--->", socket.gethostbyname(host))
```

---

## 9 – Basic Web Requests

### Using `requests`
```python
#!/usr/bin/python3
import requests

site = requests.get("http://businesscorp.com.br")
status = site.status_code

if status == 200:
    print("Page Exists")
else:
    print("Page Not Found")
```

### Using `urllib`
```python
#!/usr/bin/python3
import urllib.request

try:
    response = urllib.request.urlopen("http://businesscorp.com.br")
    print("Page Exists")
except:
    print("Page Not Found")
```
