
# Python Essentials for Pentesters

> **Focus:** using Python (legacy 2.7) to build quick scripts for scanning, grabbing banners, DNS lookups, and web checks during penetration tests.

---

## ⚠ Note on Python Version
This module was created using **Python 2.7**, the older version commonly found in legacy Linux distros and some outdated pentesting environments.

---

## Table of Contents
1. [Your First Python Script](#1-your-first-python-script)
2. [Working with Arguments](#2-working-with-arguments)
3. [Conditions and Loops](#3-conditions-and-loops)
4. [Working with Sockets](#4-working-with-sockets)
5. [Building a Port Scanner](#5-building-a-port-scanner)
6. [Banner Grabbing](#6-banner-grabbing)
7. [Interacting with Services](#7-interacting-with-services)
8. [Simple DNS Resolver](#8-simple-dns-resolver)
9. [Basic Web Requests](#9-basic-web-requests)

---

## 1 – Your First Python Script
```python
#!/usr/bin/python
# My first script
print "Desec Security"
ip = raw_input("Enter IP: ")
port = input("Enter Port: ")
ver = 1.1

print "Scan version:", ver
print "Scanning host:", ip, "on port", port

print "IP - ", type(ip)
print "Port - ", type(port)
print "Ver - ", type(ver)

print "Scanning host: %s on port: %d" % (ip, port)
```

---

## 2 – Working with Arguments
```python
#!/usr/bin/python
import sys
import os

print "Scanning host:", sys.argv[1], "on port", sys.argv[2]
os.system("netstat -nlpt")
```

---

## 3 – Conditions and Loops
```python
#!/usr/bin/python
import sys

if len(sys.argv) <= 2:
    print "Usage: script.py <ip> <port>"
else:
    print "Scanning host:", sys.argv[1], "on port", sys.argv[2]

for ip in range(1, 10):
    print sys.argv[1], ip
```

---

## 4 – Working with Sockets
```python
#!/usr/bin/python
import socket
import sys

ip = sys.argv[1]
port = int(sys.argv[2])

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
res = sock.connect_ex((ip, port))

if res == 0:
    print "Port OPEN"
else:
    print "Port CLOSED"
```

---

## 5 – Building a Port Scanner
```python
#!/usr/bin/python
import socket
import sys

for port in range(1, 65535):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    if sock.connect_ex((sys.argv[1], port)) == 0:
        print "Port", port, "[OPEN]"
    sock.close()
```

---

## 6 – Banner Grabbing
```python
#!/usr/bin/python
import socket

ip = raw_input("Enter IP: ")
port = input("Enter Port: ")

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((ip, port))
banner = sock.recv(1024)
print banner
```

---

## 7 – Interacting with Services (FTP Example)
```python
#!/usr/bin/python
import socket

print "Interacting with FTP Server"
ip = raw_input("Enter IP: ")
port = input("Enter Port: ")

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((ip, port))
banner = sock.recv(1024)
print banner

print "Sending user"
sock.send("USER ricardo\r\n")
print sock.recv(1024)

print "Sending password"
sock.send("PASS ricardo\r\n")
print sock.recv(1024)
```

---

## 8 – Simple DNS Resolver
```python
#!/usr/bin/python
import socket
import sys

host = sys.argv[1]
print host, "--->", socket.gethostbyname(host)
```

---

## 9 – Basic Web Requests

### Using `requests`
```python
#!/usr/bin/python
import requests

site = requests.get("http://businesscorp.com.br")
status = site.status_code

if status == 200:
    print "Page Exists"
else:
    print "Page Not Found"
```

### Using `urllib`
```python
#!/usr/bin/python
import urllib2

try:
    response = urllib2.urlopen("http://businesscorp.com.br")
    print "Page Exists"
except urllib2.URLError:
    print "Page Not Found"
```

---

